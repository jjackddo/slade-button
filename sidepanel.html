<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Gemini Assistant</title>
    <style>
        body,
        html,
        iframe {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border: none;
            background: #fff;
        }
    </style>
</head>

<body>
    <iframe id="gemini-frame" src="https://gemini.google.com/app" allow="clipboard-read; clipboard-write"></iframe>
    <script>
        // Listen for storage changes to force an iframe refresh when a new action is triggered
        chrome.storage.onChanged.addListener((changes, namespace) => {
            if (namespace === 'local' && (changes.pendingPrompt || changes.lastUpdate)) {
                console.log('SidePanel: New action detected, reloading Gemini...');
                const frame = document.getElementById('gemini-frame');
                if (frame) {
                    // Append a timestamp to force a real reload and potentially a new chat state
                    frame.src = "https://gemini.google.com/app?refresh=" + Date.now();
                }
            }
        });

        console.log('SidePanel: Monitor loaded');
    </script>
</body>

</html>